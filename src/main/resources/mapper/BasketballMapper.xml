<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.batch.mapper.BasketballMapper">

    <insert id="insertBasketMatch" parameterType="com.batch.model.BasketballModel">
        INSERT INTO sport.basketball_data(
                GAME_ID,
                LEAGUE,
                GROUND,
                MATCH_DATE,
                DAY_OF_WEEK,
                MATCH_TIME,
                A_TEAM_REST_DAY,
                A_TEAM, B_TEAM,
                B_TEAM_REST_DAY)
        VALUES (
                #{gameId},
                #{league},
                #{ground},
                #{date},
                #{dayOfWeek},
                #{time},
                IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM  sport.basketball_data A WHERE A_TEAM = #{aTeam} ORDER BY idx DESC LIMIT 1))) -1,0),
                #{aTeam},
                #{bTeam},
                IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM  sport.basketball_data B WHERE B_TEAM = #{bTeam} ORDER BY idx DESC LIMIT 1))) -1,0)
            )
    </insert>

    <select id="checkGameIdCount" parameterType="com.batch.model.BasketballModel" resultType="int">
       SELECT COUNT(1)
           FROM sport.basketball_data
        WHERE GAME_ID = #{gameId};
    </select>

    <update id="updateBasketStat" parameterType="com.batch.model.BasketballModel">
    UPDATE sport.basketball_data
            SET
                A_TEAM_TOTAL_POINT   =     #{aTeamTotalPoint},
                B_TEAM_TOTAL_POINT   =     #{bTeamTotalPoint},
                HANDI_CAP   =     #{handiCap},
                HANDI_CAP_RESULT   =     #{handiCapResult},
                ODD            = #{odd},
                POINT_LINE   =     #{pointLine},
                POINT_LINE_RESULT   =     #{pointLineResult},
                A_TEAM_FIRSTQ_POINT   =     #{aTeamFirstQPoint},
                B_TEAM_FIRSTQ_POINT   =     #{bTeamFirstQPoint},
                FIRSTQ_HANDI_CAP   =     #{firstQHandiCap},
                FIRSTQ_HANDI_CAP_RESULT   =     #{firstQHandiCapResult},
                FIRSTQ_POINT_LINE   =     #{firstQPointLine},
                FIRSTQ_POINT_LINE_RESULT   =     #{firstQPointLineResult},
                A_TEAM_SECONDQ_POINT   =     #{aTeamSecondQPoint},
	            B_TEAM_SECONDQ_POINT   =     #{bTeamSecondQPoint},
	            SECONDQ_HANDI_CAP_RESULT   =     #{secondQHandiCapResult},
	            SECONDQ_POINT_LINE_RESULT   =     #{secondQPointLineResult},
	            A_TEAM_THIRDQ_POINT   =     #{aTeamThirdQPoint},
	            B_TEAM_THIRDQ_POINT   =     #{bTeamThirdQPoint},
	            THIRDQ_HANDI_CAP_RESULT   =     #{thirdQHandiCapResult},
	            THIRDQ_POINT_LINE_RESULT   =     #{thirdQPointLineResult},
	            A_TEAM_FOURTHQ_POINT   =     #{aTeamFourthQPoint},
	            B_TEAM_FOURTHQ_POINT   =     #{bTeamFourthQPoint},
	            FOURTHQ_HANDI_CAP_RESULT   =     #{fourthQHandiCapResult},
	            FOURTHQ_POINT_LINE_RESULT   =     #{fourthQPointLineResult},
	            A_TEAM_FIRST_HALF_POINT     =     #{aTeamFirstHalfPoint},
                B_TEAM_FIRST_HALF_POINT     =     #{bTeamFirstHalfPoint},
                HALF_HANDI_CAP      =     #{halfHandiCap},
                FIRST_HALF_HANDI_CAP_RESULT     =     #{firstHalfHandiCapResult},
                HALF_POINT_LINE     =     #{halfPointLine},
                FIRST_HALF_POINT_LINE_RESULT        =     #{firstHalfPointLineResult},
                A_TEAM_SECOND_HALF_POINT        =     #{aTeamSecondHalfPoint},
                B_TEAM_SECOND_HALF_POINT        =     #{bTeamSecondHalfPoint},
                SECOND_HALF_HANDI_CAP_RESULT        =     #{secondHalfHandiCapResult},
                SECOND_HALF_POINT_LINE_RESULT       =     #{secondHalfPointLineResult},
                FIRSTQ_FIRST_POINT   =     #{firstQFirstPoint},
                FIRSTQ_FIRST_FREE_TWO   =     #{firstQFirstFreeTwo},
                FIRSTQ_FIRST_TWO_POINT   =     #{firstQFirstTwoPoint},
                FIRSTQ_FIRST_THREE_POINT   =     #{firstQFirstThreePoint},
                SECONDQ_FIRST_POINT   =     #{secondQFirstPoint},
                SECONDQ_FIRST_FREE_TWO   =     #{secondQFirstFreeTwo},
                SECONDQ_FIRST_TWO_POINT   =     #{secondQFirstTwoPoint},
                SECONDQ_FIRST_THREE_POINT   =     #{secondQFirstThreePoint},
                THIRDQ_FIRST_POINT   =     #{thirdQFirstPoint},
                THIRDQ_FIRST_FREE_TWO   =     #{thirdQFirstFreeTwo},
                THIRDQ_FIRST_TWO_POINT   =     #{thirdQFirstTwoPoint},
                THIRDQ_FIRST_THREE_POINT   =     #{thirdQFirstThreePoint},
                FOURTHQ_FIRST_POINT   =     #{fourthQFirstPoint},
                FOURTHQ_FIRST_FREE_TWO   =     #{fourthQFirstFreeTwo},
                FOURTHQ_FIRST_TWO_POINT   =     #{fourthQFirstTwoPoint},
                FOURTHQ_FIRST_THREE_POINT   =     #{fourthQFirstThreePoint},
                FIRSTQ_TOTAL_POINT   =     #{firstQTotalPoint},
                SECONDQ_TOTAL_POINT   =     #{secondQTotalPoint},
                THIRDQ_TOTAL_POINT   =     #{thirdQTotalPoint},
                FOURTHQ_TOTAL_POINT   =     #{fourthQTotalPoint},
                EXTENDQ_TOTAL_POINT   =     #{extendQTotalPoint}
            WHERE
                GAME_ID   =     #{gameId} AND
                LEAGUE   =     #{league} AND
                GROUND   =     #{ground} AND
                MATCH_DATE   =     #{date} AND
                A_TEAM   =     #{aTeam} AND
                B_TEAM   =     #{bTeam} AND
                UPDATE_YN = 1;
    </update>

    <select id="selectBasketballStat"  resultType="HashMap">
        SELECT LEAGUE,
               GROUND,
               MATCH_DATE,
               DAY_OF_WEEK,
               MATCH_TIME,
               A_TEAM_REST_DAY,
               A_TEAM,
               A_TEAM_TOTAL_POINT,
               B_TEAM_TOTAL_POINT,
               B_TEAM,
               B_TEAM_REST_DAY,
               HANDI_CAP,
               HANDI_CAP_RESULT,
               ODD,
               POINT_LINE,
               POINT_LINE_RESULT,
               A_TEAM_FIRSTQ_POINT,
               B_TEAM_FIRSTQ_POINT,
               FIRSTQ_HANDI_CAP,
               FIRSTQ_HANDI_CAP_RESULT,
               FIRSTQ_POINT_LINE,
               FIRSTQ_POINT_LINE_RESULT,
               A_TEAM_SECONDQ_POINT,
               B_TEAM_SECONDQ_POINT,
               SECONDQ_HANDI_CAP_RESULT,
               SECONDQ_POINT_LINE_RESULT,
               A_TEAM_THIRDQ_POINT,
               B_TEAM_THIRDQ_POINT,
               THIRDQ_HANDI_CAP_RESULT,
               THIRDQ_POINT_LINE_RESULT,
               A_TEAM_FOURTHQ_POINT,
               B_TEAM_FOURTHQ_POINT,
               FOURTHQ_HANDI_CAP_RESULT,
               FOURTHQ_POINT_LINE_RESULT,
               A_TEAM_FIRST_HALF_POINT,
               B_TEAM_FIRST_HALF_POINT,
               HALF_HANDI_CAP,
               FIRST_HALF_HANDI_CAP_RESULT,
               HALF_POINT_LINE,
               FIRST_HALF_POINT_LINE_RESULT,
               A_TEAM_SECOND_HALF_POINT,
               B_TEAM_SECOND_HALF_POINT,
               SECOND_HALF_HANDI_CAP_RESULT,
               SECOND_HALF_POINT_LINE_RESULT,
               FIRSTQ_FIRST_POINT,
               FIRSTQ_FIRST_FREE_TWO,
               FIRSTQ_FIRST_TWO_POINT,
               FIRSTQ_FIRST_THREE_POINT,
               SECONDQ_FIRST_POINT,
               SECONDQ_FIRST_FREE_TWO,
               SECONDQ_FIRST_TWO_POINT,
               SECONDQ_FIRST_THREE_POINT,
               THIRDQ_FIRST_POINT,
               THIRDQ_FIRST_FREE_TWO,
               THIRDQ_FIRST_TWO_POINT,
               THIRDQ_FIRST_THREE_POINT,
               FOURTHQ_FIRST_POINT,
               FOURTHQ_FIRST_FREE_TWO,
               FOURTHQ_FIRST_TWO_POINT,
               FOURTHQ_FIRST_THREE_POINT,
               FIRSTQ_TOTAL_POINT,
               SECONDQ_TOTAL_POINT,
               THIRDQ_TOTAL_POINT,
               FOURTHQ_TOTAL_POINT,
               EXTENDQ_TOTAL_POINT
        FROM   sport.BASKETBALL_DATA
                WHERE EXCEPT_YN = 0
        ORDER  BY MATCH_DATE,
                      MATCH_TIME,
                      LEAGUE,
                      GAME_ID;
    </select>

    <insert id="insertBasketballSpecialSummary" parameterType="com.batch.model.FilterConditionModel">
        INSERT INTO sport.basketball_special_summary
                    (
                                league,
                                team,
                                filter,
                                condi,
                                first_first_point_per,
                                second_first_point_per,
                                third_first_point_per,
                                fourth_first_point_per,
                                first_first_two_point_per,
                                second_first_two_point_per,
                                third_first_two_point_per,
                                fourth_first_two_point_per,
                                first_first_free_two_per,
                                second_first_free_two_per,
                                third_first_free_two_per,
                                fourth_first_free_two_per,
                                first_first_three_point_per,
                                second_first_three_point_per,
                                third_first_three_point_per,
                                fourth_first_three_point_per,
                                rdate
                    )
            SELECT A.LEAGUE,
                   A.A_TEAM,
                   <if test="all">
                       '전체',
                       'all',
                   </if>
                   <if test="ground">
                       '홈/원정',
                       A.GROUND,
                   </if>
                   <if test="week">
                       '요일',
                       A.DAY_OF_WEEK,
                   </if>
                   <if test="odd">
                       '정/역배',
                       A.ODD,
                   </if>
                   <if test="rest">
                       '휴식일',
                       A.A_TEAM_REST_DAY,
                   </if>
                   ROUND(FIRST_FIRST_POINT_RES / ALLCNT * 100, 1)        AS       first_first_point_per,
                   ROUND(SECOND_FIRST_POINT_RES / ALLCNT * 100, 1)       AS       second_first_point_per,
                   ROUND(THIRD_FIRST_POINT_RES / ALLCNT * 100, 1)        AS       third_first_point_per,
                   ROUND(FOURTH_FIRST_POINT_RES / ALLCNT * 100, 1)       AS       fourth_first_point_per,
                   ROUND(FIRST_FIRST_TWO_POINT_RES / ALLCNT * 100, 1)    AS       first_first_two_point_per,
                   ROUND(SECOND_FIRST_TWO_POINT_RES / ALLCNT * 100, 1)   AS       second_first_two_point_per,
                   ROUND(THIRD_FIRST_TWO_POINT_RES / ALLCNT * 100, 1)    AS       third_first_two_point_per,
                   ROUND(FOURTH_FIRST_TWO_POINT_RES / ALLCNT * 100, 1)   AS       fourth_first_two_point_per,
                   ROUND(FIRST_FIRST_FREE_TWO_RES / ALLCNT * 100, 1)     AS       first_first_free_two_per,
                   ROUND(SECOND_FIRST_FREE_TWO_RES / ALLCNT * 100, 1)    AS       second_first_free_two_per,
                   ROUND(THIRD_FIRST_FREE_TWO_RES / ALLCNT * 100, 1)     AS       third_first_free_two_per,
                   ROUND(FOURTH_FIRST_FREE_TWO_RES / ALLCNT * 100, 1)    AS       fourth_first_free_two_per,
                   ROUND(FIRST_FIRST_THREE_POINT_RES / ALLCNT * 100, 1)  AS       first_first_three_point_per,
                   ROUND(SECOND_FIRST_THREE_POINT_RES / ALLCNT * 100, 1) AS       second_first_three_point_per,
                   ROUND(THIRD_FIRST_THREE_POINT_RES / ALLCNT * 100, 1)  AS       third_first_three_point_per,
                   ROUND(FOURTH_FIRST_THREE_POINT_RES / ALLCNT * 100, 1) AS       fourth_first_three_point_per,
                   NOW()
  FROM (SELECT LEAGUE,
               A_TEAM,
               <if test="all">
                   'all',
               </if>
               <if test="ground">
                   A.GROUND,
               </if>
               <if test="week">
                   A.DAY_OF_WEEK,
               </if>
               <if test="odd">
                   A.ODD,
               </if>
               <if test="rest">
                   A.A_TEAM_REST_DAY,
               </if>
               COUNT(1) AS allCnt
          FROM sport.basketball_data A
         WHERE  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) A
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS first_first_point_res
                          FROM sport.basketball_data
                         WHERE FIRSTQ_FIRST_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) B
                    ON A.A_TEAM = B.A_TEAM
                     <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = B.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = B.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = B.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS second_first_point_res
                          FROM sport.basketball_data
                         WHERE SECONDQ_FIRST_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) C
                    ON A.A_TEAM = C.A_TEAM
                     <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = C.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = C.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = C.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = C.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = C.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS third_first_point_res
                          FROM sport.basketball_data
                         WHERE THIRDQ_FIRST_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) D
                    ON A.A_TEAM = D.A_TEAM
                     <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = D.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = D.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = D.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = D.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = D.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS fourth_first_point_res
                          FROM sport.basketball_data
                         WHERE FOURTHQ_FIRST_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) E
                    ON A.A_TEAM = E.A_TEAM
                     <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = E.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = E.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = E.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = E.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = E.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS first_first_two_point_res
                          FROM sport.basketball_data
                         WHERE FIRSTQ_FIRST_TWO_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) B2
                    ON A.A_TEAM = B2.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = B2.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = B2.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = B2.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = B2.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = B2.LEAGUE
                LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS second_first_two_point_res
                          FROM sport.basketball_data
                         WHERE SECONDQ_FIRST_TWO_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) C2
                    ON A.A_TEAM = C2.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = C2.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = C2.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = C2.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = C2.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = C2.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS third_first_two_point_res
                          FROM sport.basketball_data
                         WHERE THIRDQ_FIRST_TWO_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) D2
                    ON A.A_TEAM = D2.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = D2.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = D2.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = D2.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = D2.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = D2.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS fourth_first_two_point_res
                          FROM sport.basketball_data
                         WHERE FOURTHQ_FIRST_TWO_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) E2
                    ON A.A_TEAM = E2.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = E2.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = E2.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = E2.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = E2.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = E2.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS first_first_free_two_res
                          FROM sport.basketball_data
                         WHERE FIRSTQ_FIRST_FREE_TWO = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) B3
                    ON A.A_TEAM = B3.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = B3.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = B3.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = B3.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = B3.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = B3.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS second_first_free_two_res
                          FROM sport.basketball_data
                         WHERE SECONDQ_FIRST_FREE_TWO = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) C3
                    ON A.A_TEAM = C3.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = C3.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = C3.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = C3.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = C3.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = C3.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS third_first_free_two_res
                          FROM sport.basketball_data
                         WHERE THIRDQ_FIRST_FREE_TWO = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) D3
                    ON A.A_TEAM = D3.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = D3.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = D3.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = D3.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = D3.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = D3.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                     <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS fourth_first_free_two_res
                          FROM sport.basketball_data
                         WHERE FOURTHQ_FIRST_FREE_TWO = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) E3
                    ON A.A_TEAM = E3.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = E3.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = E3.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = E3.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = E3.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = E3.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS first_first_three_point_res
                          FROM sport.basketball_data
                         WHERE FIRSTQ_FIRST_THREE_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) B4
                    ON A.A_TEAM = B4.A_TEAM
                        <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = B4.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = B4.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = B4.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = B4.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = B4.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS second_first_three_point_res
                          FROM sport.basketball_data
                         WHERE SECONDQ_FIRST_THREE_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) C4
                    ON A.A_TEAM = C4.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = C4.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = C4.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = C4.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = C4.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = C4.LEAGUE
       LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS third_first_three_point_res
                          FROM sport.basketball_data
                         WHERE THIRDQ_FIRST_THREE_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) D4
                    ON A.A_TEAM = D4.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = D4.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = D4.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = D4.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = D4.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = D4.LEAGUE
            LEFT OUTER JOIN (SELECT LEAGUE,
                               A_TEAM,
                                    <if test="all">
                                        'all',
                                    </if>
                                    <if test="ground">
                                        GROUND,
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK,
                                    </if>
                                    <if test="odd">
                                        ODD,
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY,
                                    </if>
                               COUNT(1) AS fourth_first_three_point_res
                          FROM sport.basketball_data
                         WHERE FOURTHQ_FIRST_THREE_POINT = '승리'
                               AND  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                         GROUP  BY LEAGUE,
                                     A_TEAM,
                                    <if test="all">
                                        'all'
                                    </if>
                                    <if test="ground">
                                        GROUND
                                    </if>
                                    <if test="week">
                                        DAY_OF_WEEK
                                    </if>
                                    <if test="odd">
                                        ODD
                                    </if>
                                    <if test="rest">
                                        A_TEAM_REST_DAY
                                    </if>) E4
                    ON A.A_TEAM = E4.A_TEAM
                   <if test="all">
                     </if>
                     <if test="ground">
                         AND A.GROUND = E4.GROUND
                     </if>
                     <if test="week">
                         AND A.DAY_OF_WEEK = E4.DAY_OF_WEEK
                     </if>
                     <if test="odd">
                         AND A.ODD = E4.ODD
                     </if>
                     <if test="rest">
                         AND A.A_TEAM_REST_DAY = E4.A_TEAM_REST_DAY
                     </if>
                       AND A.LEAGUE = E4.LEAGUE
    </insert>


    <insert id="truncateBasketballSpecialSummary">
        TRUNCATE sport.basketball_special_summary
    </insert>


    <insert id="insertBasketHandiOverSummary">

        INSERT INTO sport.basketball_handi_over_summary
                    (LEAGUE,
                     TEAM,
                     FILTER,
                     CONDI,
                     HANDI_WIN_PER,
                     HANDI_LOSE_PER,
                     OVER_PER,
                     UNDER_PER,
                     RDATE)
        SELECT A.LEAGUE,
               A.A_TEAM,
                <if test="all">
                     '전체',
                     'all',
                 </if>
                 <if test="ground">
                     '홈/원정',
                     A.GROUND,
                 </if>
                 <if test="week">
                     '요일',
                     A.DAY_OF_WEEK,
                 </if>
                 <if test="odd">
                     '정/역배',
                     A.ODD,
                 </if>
                 <if test="rest">
                     '휴식일',
                     A.A_TEAM_REST_DAY,
                 </if>
               ROUND(WINCNT / ALLHANDICNT * 100, 1)        AS winPer,
               100 - ROUND(WINCNT / ALLHANDICNT * 100, 1)  AS losePer,
               ROUND(OVERCNT / ALLPOINTCNT * 100, 1)       AS overPer,
               100 - ROUND(OVERCNT / ALLPOINTCNT * 100, 1) AS underPer,
               NOW()
        FROM   (SELECT LEAGUE,
                       A_TEAM,
                          <if test="all">
                               '전체',
                               'all',
                           </if>
                           <if test="ground">
                               '홈/원정',
                               A.GROUND,
                           </if>
                           <if test="week">
                               '요일',
                               A.DAY_OF_WEEK,
                           </if>
                           <if test="odd">
                               '정/역배',
                               A.ODD,
                           </if>
                           <if test="rest">
                               '휴식일',
                               A.A_TEAM_REST_DAY,
                           </if>
                       COUNT(1) allHandiCnt
                FROM   sport.basketball_data A
                WHERE  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                       AND HANDI_CAP_RESULT != '적특'
                 GROUP  BY LEAGUE,
                            A_TEAM,
                           <if test="all">
                               'all'
                           </if>
                           <if test="ground">
                               GROUND
                           </if>
                           <if test="week">
                               DAY_OF_WEEK
                           </if>
                           <if test="odd">
                               ODD
                           </if>
                           <if test="rest">
                               A_TEAM_REST_DAY
                           </if>) A
               LEFT OUTER JOIN (SELECT LEAGUE,
                                       A_TEAM,
                                      <if test="all">
                                           '전체',
                                           'all',
                                       </if>
                                       <if test="ground">
                                           '홈/원정',
                                           A.GROUND,
                                       </if>
                                       <if test="week">
                                           '요일',
                                           A.DAY_OF_WEEK,
                                       </if>
                                       <if test="odd">
                                           '정/역배',
                                           A.ODD,
                                       </if>
                                       <if test="rest">
                                           '휴식일',
                                           A.A_TEAM_REST_DAY,
                                       </if>
                                       COUNT(1) winCnt
                                FROM   sport.basketball_data A
                                WHERE  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                                       AND HANDI_CAP_RESULT != '적특'
                                       AND HANDI_CAP_RESULT = '승리'
                                 GROUP  BY LEAGUE,
                                            A_TEAM,
                                           <if test="all">
                                               'all'
                                           </if>
                                           <if test="ground">
                                               GROUND
                                           </if>
                                           <if test="week">
                                               DAY_OF_WEEK
                                           </if>
                                           <if test="odd">
                                               ODD
                                           </if>
                                           <if test="rest">
                                               A_TEAM_REST_DAY
                                           </if>)B
                                ON A.A_TEAM = B.A_TEAM
                                 <if test="all">
                                 </if>
                                 <if test="ground">
                                     AND A.GROUND = B.GROUND
                                 </if>
                                 <if test="week">
                                     AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                                 </if>
                                 <if test="odd">
                                     AND A.ODD = B.ODD
                                 </if>
                                 <if test="rest">
                                     AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                                 </if>
                                   AND A.LEAGUE = B.LEAGUE
               LEFT OUTER JOIN (SELECT LEAGUE,
                                       A_TEAM,
                                      <if test="all">
                                           '전체',
                                           'all',
                                       </if>
                                       <if test="ground">
                                           '홈/원정',
                                           A.GROUND,
                                       </if>
                                       <if test="week">
                                           '요일',
                                           A.DAY_OF_WEEK,
                                       </if>
                                       <if test="odd">
                                           '정/역배',
                                           A.ODD,
                                       </if>
                                       <if test="rest">
                                           '휴식일',
                                           A.A_TEAM_REST_DAY,
                                       </if>
                                       COUNT(1) allPointCnt
                                FROM   sport.basketball_data A
                                WHERE  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                                       AND POINT_LINE_RESULT != '적특'
                                 GROUP  BY LEAGUE,
                                            A_TEAM,
                                           <if test="all">
                                               'all'
                                           </if>
                                           <if test="ground">
                                               GROUND
                                           </if>
                                           <if test="week">
                                               DAY_OF_WEEK
                                           </if>
                                           <if test="odd">
                                               ODD
                                           </if>
                                           <if test="rest">
                                               A_TEAM_REST_DAY
                                           </if>) C
                            ON A.A_TEAM = C.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = C.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = C.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = C.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = C.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = C.LEAGUE
               LEFT OUTER JOIN (SELECT LEAGUE,
                                       A_TEAM,
                                      <if test="all">
                                           '전체',
                                           'all',
                                       </if>
                                       <if test="ground">
                                           '홈/원정',
                                           A.GROUND,
                                       </if>
                                       <if test="week">
                                           '요일',
                                           A.DAY_OF_WEEK,
                                       </if>
                                       <if test="odd">
                                           '정/역배',
                                           A.ODD,
                                       </if>
                                       <if test="rest">
                                           '휴식일',
                                           A.A_TEAM_REST_DAY,
                                       </if>
                                       COUNT(1) overCnt
                                FROM   sport.basketball_data A
                                WHERE  <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                                       AND POINT_LINE_RESULT != '적특'
                                       AND POINT_LINE_RESULT = '오버'
                                 GROUP  BY LEAGUE,
                                            A_TEAM,
                                           <if test="all">
                                               'all'
                                           </if>
                                           <if test="ground">
                                               GROUND
                                           </if>
                                           <if test="week">
                                               DAY_OF_WEEK
                                           </if>
                                           <if test="odd">
                                               ODD
                                           </if>
                                           <if test="rest">
                                               A_TEAM_REST_DAY
                                           </if>)D
                                ON A.A_TEAM = D.A_TEAM
                                 <if test="all">
                                 </if>
                                 <if test="ground">
                                     AND A.GROUND = D.GROUND
                                 </if>
                                 <if test="week">
                                     AND A.DAY_OF_WEEK = D.DAY_OF_WEEK
                                 </if>
                                 <if test="odd">
                                     AND A.ODD = D.ODD
                                 </if>
                                 <if test="rest">
                                     AND A.A_TEAM_REST_DAY = D.A_TEAM_REST_DAY
                                 </if>
                                   AND A.LEAGUE = D.LEAGUE
    </insert>

    <insert id="truncateBasketHandiOverSummary">
        TRUNCATE sport.basketball_handi_over_summary
    </insert>

    <insert id="insertBasketQuarterHandiOverSummary">
        INSERT INTO sport.basketball_quarter_handi_over_summary
            (LEAGUE,
             TEAM,
             FILTER,
             CONDI,
             FIRST_HANDI_WIN_PER,
             FIRST_HANDI_LOSE_PER,
             SECOND_HANDI_WIN_PER,
             SECOND_HANDI_LOSE_PER,
             THIRD_HANDI_WIN_PER,
             HIRD_HANDI_LOSE_PER,
             FOURTH_HANDI_WIN_PER,
             OURTH_HANDI_LOSE_PER,
             FIRST_OVER_PER,
             FIRST_UNDER_PER,
             SECOND_OVER_PER,
             SECOND_UNDER_PER,
             THIRD_OVER_PER,
             THIRD_UNDER_PER,
             FOURTH_OVER_PER,
             FOURTH_UNDER_PER,
             RDATE)
        SELECT A.LEAGUE,
               A.A_TEAM ,
               <if test="all">
                   '전체',
                   'all',
               </if>
               <if test="ground">
                   '홈/원정',
                   A.GROUND,
               </if>
               <if test="week">
                   '요일',
                   A.DAY_OF_WEEK,
               </if>
               <if test="odd">
                   '정/역배',
                   A.ODD,
               </if>
               <if test="rest">
                   '휴식일',
                   A.A_TEAM_REST_DAY,
               </if>
               first_handi_win_per ,
               100 - first_handi_win_per AS first_handi_lose_per ,
               second_handi_win_per ,
               100 - second_handi_win_per AS second_handi_lose_per ,
               third_handi_win_per ,
               100 - third_handi_win_per AS third_handi_lose_per ,
               fourth_handi_win_per ,
               100 - fourth_handi_win_per AS fourth_handi_lose_per ,
               first_over_per ,
               100 - first_over_per AS first_under_per ,
               second_over_per ,
               100 - second_over_per AS second_under_per ,
               third_over_per ,
               100 - third_over_per AS third_under_per ,
               fourth_over_per ,
               100 - fourth_over_per AS fourth_under_per ,
               NOW()
        FROM
          (SELECT A.LEAGUE,
                  A.A_TEAM,
                  <if test="all">
                      'all',
                  </if>
                  <if test="ground">
                      A.GROUND,
                  </if>
                  <if test="week">
                      A.DAY_OF_WEEK,
                  </if>
                  <if test="odd">
                      A.ODD,
                  </if>
                  <if test="rest">
                      A.A_TEAM_REST_DAY,
                  </if>
                  allCnt ,
                  first_res,
                  ROUND(first_res/allCnt * 100, 1) AS first_handi_win_per
           FROM
             (SELECT LEAGUE,
                     A_TEAM,
                       <if test="all">
                           'all',
                       </if>
                       <if test="ground">
                           GROUND,
                       </if>
                       <if test="week">
                           DAY_OF_WEEK,
                       </if>
                       <if test="odd">
                           ODD,
                       </if>
                       <if test="rest">
                           A_TEAM_REST_DAY,
                       </if>
                     COUNT(1) AS allCnt
              FROM sport.basketball_data
              WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                 GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) A
           LEFT OUTER JOIN
             (SELECT LEAGUE,
                     A_TEAM,
                       <if test="all">
                           'all',
                       </if>
                       <if test="ground">
                           GROUND,
                       </if>
                       <if test="week">
                           DAY_OF_WEEK,
                       </if>
                       <if test="odd">
                           ODD,
                       </if>
                       <if test="rest">
                           A_TEAM_REST_DAY,
                       </if>
                     COUNT(1) AS first_res
              FROM sport.basketball_data
              WHERE FIRSTQ_HANDI_CAP_RESULT = '승리'
                AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) B
                            ON A.A_TEAM = B.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = B.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = B.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = B.LEAGUE) A
        LEFT OUTER JOIN
          (SELECT A.LEAGUE,
                  A.A_TEAM,
                  <if test="all">
                      'all',
                  </if>
                  <if test="ground">
                      A.GROUND,
                  </if>
                  <if test="week">
                      A.DAY_OF_WEEK,
                  </if>
                  <if test="odd">
                      A.ODD,
                  </if>
                  <if test="rest">
                      A.A_TEAM_REST_DAY,
                  </if>
                  allCnt ,
                  second_res,
                  ROUND(second_res/allCnt * 100, 1) AS second_handi_win_per
           FROM
             (SELECT LEAGUE,
                     A_TEAM,
                       <if test="all">
                           'all',
                       </if>
                       <if test="ground">
                           GROUND,
                       </if>
                       <if test="week">
                           DAY_OF_WEEK,
                       </if>
                       <if test="odd">
                           ODD,
                       </if>
                       <if test="rest">
                           A_TEAM_REST_DAY,
                       </if>
                     COUNT(1) AS allCnt
              FROM sport.basketball_data
              WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                AND SECONDQ_HANDI_CAP_RESULT != '적특'
                  GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) A
           LEFT OUTER JOIN
             (SELECT LEAGUE,
                     A_TEAM,
                       <if test="all">
                           'all',
                       </if>
                       <if test="ground">
                           GROUND,
                       </if>
                       <if test="week">
                           DAY_OF_WEEK,
                       </if>
                       <if test="odd">
                           ODD,
                       </if>
                       <if test="rest">
                           A_TEAM_REST_DAY,
                       </if>
                     COUNT(1) AS second_res
              FROM sport.basketball_data
              WHERE SECONDQ_HANDI_CAP_RESULT = '승리'
                AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) B
                          ON A.A_TEAM = B.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = B.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = B.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = B.LEAGUE
                          ) B
                            ON A.A_TEAM = B.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = B.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = B.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = B.LEAGUE
        LEFT OUTER JOIN
          (SELECT A.LEAGUE,
                  A.A_TEAM,
                  <if test="all">
                      'all',
                  </if>
                  <if test="ground">
                      A.GROUND,
                  </if>
                  <if test="week">
                      A.DAY_OF_WEEK,
                  </if>
                  <if test="odd">
                      A.ODD,
                  </if>
                  <if test="rest">
                      A.A_TEAM_REST_DAY,
                  </if>
                  allCnt ,
                  third_res,
                  ROUND(third_res/allCnt * 100, 1) AS third_handi_win_per
           FROM
             (SELECT LEAGUE,
                     A_TEAM,
                       <if test="all">
                           'all',
                       </if>
                       <if test="ground">
                           GROUND,
                       </if>
                       <if test="week">
                           DAY_OF_WEEK,
                       </if>
                       <if test="odd">
                           ODD,
                       </if>
                       <if test="rest">
                           A_TEAM_REST_DAY,
                       </if>
                     COUNT(1) AS allCnt
              FROM sport.basketball_data
              WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                AND THIRDQ_HANDI_CAP_RESULT != '적특'
                 GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) A
           LEFT OUTER JOIN
             (SELECT LEAGUE,
                     A_TEAM,
                       <if test="all">
                           'all',
                       </if>
                       <if test="ground">
                           GROUND,
                       </if>
                       <if test="week">
                           DAY_OF_WEEK,
                       </if>
                       <if test="odd">
                           ODD,
                       </if>
                       <if test="rest">
                           A_TEAM_REST_DAY,
                       </if>
                     COUNT(1) AS third_res
              FROM sport.basketball_data
              WHERE THIRDQ_HANDI_CAP_RESULT = '승리'
                AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) B
                            ON A.A_TEAM = B.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = B.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = B.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = B.LEAGUE) C
                            ON A.A_TEAM = C.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = C.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = C.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = C.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = C.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = C.LEAGUE
        LEFT OUTER JOIN
          (SELECT A.LEAGUE,
                  A.A_TEAM,
                  <if test="all">
                      'all',
                  </if>
                  <if test="ground">
                      A.GROUND,
                  </if>
                  <if test="week">
                      A.DAY_OF_WEEK,
                  </if>
                  <if test="odd">
                      A.ODD,
                  </if>
                  <if test="rest">
                      A.A_TEAM_REST_DAY,
                  </if>
                  allCnt ,
                  fourth_res,
                  ROUND(fourth_res/allCnt * 100, 1) AS fourth_handi_win_per
           FROM
             (SELECT LEAGUE,
                     A_TEAM,
                       <if test="all">
                           'all',
                       </if>
                       <if test="ground">
                           GROUND,
                       </if>
                       <if test="week">
                           DAY_OF_WEEK,
                       </if>
                       <if test="odd">
                           ODD,
                       </if>
                       <if test="rest">
                           A_TEAM_REST_DAY,
                       </if>
                     COUNT(1) AS allCnt
              FROM sport.basketball_data
              WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                 GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) A
           LEFT OUTER JOIN
             (SELECT LEAGUE,
                     A_TEAM,
                       <if test="all">
                           'all',
                       </if>
                       <if test="ground">
                           GROUND,
                       </if>
                       <if test="week">
                           DAY_OF_WEEK,
                       </if>
                       <if test="odd">
                           ODD,
                       </if>
                       <if test="rest">
                           A_TEAM_REST_DAY,
                       </if>
                     COUNT(1) AS fourth_res
              FROM sport.basketball_data
              WHERE FOURTHQ_HANDI_CAP_RESULT = '승리'
                AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) B
                             ON A.A_TEAM = B.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = B.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = B.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = B.LEAGUE ) D
                            ON A.A_TEAM = D.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = D.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = D.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = D.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = D.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = D.LEAGUE
        LEFT OUTER JOIN
          (SELECT A2.LEAGUE,
                  A2.A_TEAM ,
                 <if test="all">
                      'all',
                  </if>
                  <if test="ground">
                      A2.GROUND,
                  </if>
                  <if test="week">
                      A2.DAY_OF_WEEK,
                  </if>
                  <if test="odd">
                      A2.ODD,
                  </if>
                  <if test="rest">
                      A2.A_TEAM_REST_DAY,
                  </if>
                  first_over_per ,
                  100 - first_over_per AS first_handi_under_per ,
                  second_over_per ,
                  100 - second_over_per AS second_handi_under_per ,
                  third_over_per ,
                  100 - third_over_per AS third_handi_under_per ,
                  fourth_over_per ,
                  100 - fourth_over_per AS fourth_handi_under_per
           FROM
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                      <if test="all">
                          'all',
                      </if>
                      <if test="ground">
                          A.GROUND,
                      </if>
                      <if test="week">
                          A.DAY_OF_WEEK,
                      </if>
                      <if test="odd">
                          A.ODD,
                      </if>
                      <if test="rest">
                          A.A_TEAM_REST_DAY,
                      </if>
                     allCnt ,
                     first_res,
                     ROUND(first_res/allCnt * 100, 1) AS first_over_per
              FROM
                (SELECT LEAGUE,
                     A_TEAM,
                       <if test="all">
                           'all',
                       </if>
                       <if test="ground">
                           GROUND,
                       </if>
                       <if test="week">
                           DAY_OF_WEEK,
                       </if>
                       <if test="odd">
                           ODD,
                       </if>
                       <if test="rest">
                           A_TEAM_REST_DAY,
                       </if>
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND FIRSTQ_POINT_LINE_RESULT != '적특'
                    GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                         A_TEAM,
                           <if test="all">
                               'all',
                           </if>
                           <if test="ground">
                               GROUND,
                           </if>
                           <if test="week">
                               DAY_OF_WEEK,
                           </if>
                           <if test="odd">
                               ODD,
                           </if>
                           <if test="rest">
                               A_TEAM_REST_DAY,
                           </if>
                        COUNT(1) AS first_res
                 FROM sport.basketball_data
                 WHERE FIRSTQ_POINT_LINE_RESULT = '오버'
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                    GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) B
                            ON A.A_TEAM = B.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = B.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = B.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = B.LEAGUE) A2
           LEFT OUTER JOIN
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                      <if test="all">
                          'all',
                      </if>
                      <if test="ground">
                          A.GROUND,
                      </if>
                      <if test="week">
                          A.DAY_OF_WEEK,
                      </if>
                      <if test="odd">
                          A.ODD,
                      </if>
                      <if test="rest">
                          A.A_TEAM_REST_DAY,
                      </if>
                     allCnt ,
                     second_res,
                     ROUND(second_res/allCnt * 100, 1) AS second_over_per
              FROM
                (SELECT LEAGUE,
                         A_TEAM,
                           <if test="all">
                               'all',
                           </if>
                           <if test="ground">
                               GROUND,
                           </if>
                           <if test="week">
                               DAY_OF_WEEK,
                           </if>
                           <if test="odd">
                               ODD,
                           </if>
                           <if test="rest">
                               A_TEAM_REST_DAY,
                           </if>
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND SECONDQ_POINT_LINE_RESULT != '적특'
                    GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                         A_TEAM,
                           <if test="all">
                               'all',
                           </if>
                           <if test="ground">
                               GROUND,
                           </if>
                           <if test="week">
                               DAY_OF_WEEK,
                           </if>
                           <if test="odd">
                               ODD,
                           </if>
                           <if test="rest">
                               A_TEAM_REST_DAY,
                           </if>
                        COUNT(1) AS second_res
                 FROM sport.basketball_data
                 WHERE SECONDQ_POINT_LINE_RESULT = '오버'
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                    GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) B
                            ON A.A_TEAM = B.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = B.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = B.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = B.LEAGUE) B2
                            ON A2.A_TEAM = B2.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A2.GROUND = B2.GROUND
                             </if>
                             <if test="week">
                                 AND A2.DAY_OF_WEEK = B2.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A2.ODD = B2.ODD
                             </if>
                             <if test="rest">
                                 AND A2.A_TEAM_REST_DAY = B2.A_TEAM_REST_DAY
                             </if>
                               AND A2.LEAGUE = B2.LEAGUE
           LEFT OUTER JOIN
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                      <if test="all">
                          'all',
                      </if>
                      <if test="ground">
                          A.GROUND,
                      </if>
                      <if test="week">
                          A.DAY_OF_WEEK,
                      </if>
                      <if test="odd">
                          A.ODD,
                      </if>
                      <if test="rest">
                          A.A_TEAM_REST_DAY,
                      </if>
                     allCnt ,
                     third_res,
                     ROUND(third_res/allCnt * 100, 1) AS third_over_per
              FROM
                (SELECT LEAGUE,
                         A_TEAM,
                           <if test="all">
                               'all',
                           </if>
                           <if test="ground">
                               GROUND,
                           </if>
                           <if test="week">
                               DAY_OF_WEEK,
                           </if>
                           <if test="odd">
                               ODD,
                           </if>
                           <if test="rest">
                               A_TEAM_REST_DAY,
                           </if>
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND THIRDQ_POINT_LINE_RESULT != '적특'
                    GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                         A_TEAM,
                           <if test="all">
                               'all',
                           </if>
                           <if test="ground">
                               GROUND,
                           </if>
                           <if test="week">
                               DAY_OF_WEEK,
                           </if>
                           <if test="odd">
                               ODD,
                           </if>
                           <if test="rest">
                               A_TEAM_REST_DAY,
                           </if>
                        COUNT(1) AS third_res
                 FROM sport.basketball_data
                 WHERE THIRDQ_POINT_LINE_RESULT = '오버'
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                    GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) B
                             ON A.A_TEAM = B.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = B.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = B.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = B.LEAGUE ) C2
                            ON A2.A_TEAM = C2.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A2.GROUND = C2.GROUND
                             </if>
                             <if test="week">
                                 AND A2.DAY_OF_WEEK = C2.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A2.ODD = C2.ODD
                             </if>
                             <if test="rest">
                                 AND A2.A_TEAM_REST_DAY = C2.A_TEAM_REST_DAY
                             </if>
                               AND A2.LEAGUE = C2.LEAGUE
           LEFT OUTER JOIN
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                      <if test="all">
                          'all',
                      </if>
                      <if test="ground">
                          A.GROUND,
                      </if>
                      <if test="week">
                          A.DAY_OF_WEEK,
                      </if>
                      <if test="odd">
                          A.ODD,
                      </if>
                      <if test="rest">
                          A.A_TEAM_REST_DAY,
                      </if>
                     allCnt ,
                     fourth_res,
                     ROUND(fourth_res/allCnt * 100, 1) AS fourth_over_per
              FROM
                (SELECT LEAGUE,
                         A_TEAM,
                           <if test="all">
                               'all',
                           </if>
                           <if test="ground">
                               GROUND,
                           </if>
                           <if test="week">
                               DAY_OF_WEEK,
                           </if>
                           <if test="odd">
                               ODD,
                           </if>
                           <if test="rest">
                               A_TEAM_REST_DAY,
                           </if>
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND FOURTHQ_POINT_LINE_RESULT != '적특'
                    GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                         A_TEAM,
                           <if test="all">
                               'all',
                           </if>
                           <if test="ground">
                               GROUND,
                           </if>
                           <if test="week">
                               DAY_OF_WEEK,
                           </if>
                           <if test="odd">
                               ODD,
                           </if>
                           <if test="rest">
                               A_TEAM_REST_DAY,
                           </if>
                        COUNT(1) AS fourth_res
                 FROM sport.basketball_data
                 WHERE FOURTHQ_POINT_LINE_RESULT = '오버'
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                    GROUP  BY LEAGUE,
                           A_TEAM,
                          <if test="all">
                              'all'
                          </if>
                          <if test="ground">
                              GROUND
                          </if>
                          <if test="week">
                              DAY_OF_WEEK
                          </if>
                          <if test="odd">
                              ODD
                          </if>
                          <if test="rest">
                              A_TEAM_REST_DAY
                          </if>) B
                              ON A.A_TEAM = B.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = B.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = B.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = B.LEAGUE) D2
                            ON A2.A_TEAM = D2.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A2.GROUND = D2.GROUND
                             </if>
                             <if test="week">
                                 AND A2.DAY_OF_WEEK = D2.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A2.ODD = D2.ODD
                             </if>
                             <if test="rest">
                                 AND A2.A_TEAM_REST_DAY = D2.A_TEAM_REST_DAY
                             </if>
                               AND A2.LEAGUE = B2.LEAGUE) A2
                            ON A.A_TEAM = A2.A_TEAM
                             <if test="all">
                             </if>
                             <if test="ground">
                                 AND A.GROUND = A2.GROUND
                             </if>
                             <if test="week">
                                 AND A.DAY_OF_WEEK = A2.DAY_OF_WEEK
                             </if>
                             <if test="odd">
                                 AND A.ODD = A2.ODD
                             </if>
                             <if test="rest">
                                 AND A.A_TEAM_REST_DAY = A2.A_TEAM_REST_DAY
                             </if>
                               AND A.LEAGUE = A2.LEAGUE
    </insert>

    <insert id="truncateBasketQuarterHandiOverSummary">
        TRUNCATE sport.basketball_quarter_handi_over_summary
    </insert>

    <insert id="insertBasketSpecialComboSummary">
        INSERT INTO sport.basketball_special_combo_summary
                    (LEAGUE,
                     TEAM,
                     FIRST_HANDI_THREE_PER,
                     SECOND_HANDI_THREE_PER,
                     THIRD_HANDI_THREE_PER,
                     FOURTH_HANDI_THREE_PER,
                     FIRST_HANDI_FREE_PER,
                     SECOND_HANDI_FREE_PER,
                     THIRD_HANDI_FREE_PER,
                     FOURTH_HANDI_FREE_PER,
                     FIRST_THREE_FREE_PER,
                     SECOND_THREE_FREE_PER,
                     THIRD_THREE_FREE_PER,
                     FOURTH_THREE_FREE_PER,
                     RDATE)
        SELECT A.LEAGUE,
               A.A_TEAM,
               ROUND(FIRST_HANDI_THREE_RES / ALLCNT * 100, 1) AS first_handi_three_per,
               ROUND(SECOND_HANDI_THREE_RES / ALLCNT * 100, 1) AS second_handi_three_per ,
               ROUND(THIRD_HANDI_THREE_RES / ALLCNT * 100, 1) AS third_handi_three_per,
               ROUND(FOURTH_HANDI_THREE_RES / ALLCNT * 100, 1) AS fourth_handi_three_per ,
               ROUND(FIRST_HANDI_FREE_RES / ALLCNT * 100, 1) AS first_handi_free_per,
               ROUND(SECOND_HANDI_FREE_RES / ALLCNT * 100, 1) AS second_handi_free_per,
               ROUND(THIRD_HANDI_FREE_RES / ALLCNT * 100, 1) AS third_handi_free_per,
               ROUND(FOURTH_HANDI_FREE_RES / ALLCNT * 100, 1) AS fourth_handi_free_per,
               ROUND(FIRST_THREE_FREE_RES / ALLCNT * 100, 1) AS first_three_free_per,
               ROUND(SECOND_THREE_FREE_RES / ALLCNT * 100, 1) AS second_three_free_per,
               ROUND(THIRD_THREE_FREE_RES / ALLCNT * 100, 1) AS third_three_free_per,
               ROUND(FOURTH_THREE_FREE_RES / ALLCNT * 100, 1) AS fourth_three_free_per,
               NOW()
        FROM
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS allCnt
           FROM sport.basketball_data
           WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) A
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS first_handi_three_res
           FROM sport.basketball_data
           WHERE FIRSTQ_FIRST_THREE_POINT = '승리'
             AND FIRSTQ_HANDI_CAP_RESULT IN ('승리',
                                             '적특')
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) B ON A.A_TEAM = B.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS second_handi_three_res
           FROM sport.basketball_data
           WHERE SECONDQ_FIRST_THREE_POINT = '승리'
             AND SECONDQ_HANDI_CAP_RESULT IN ('승리',
                                              '적특')
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) C ON A.A_TEAM = C.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS third_handi_three_res
           FROM sport.basketball_data
           WHERE THIRDQ_FIRST_THREE_POINT = '승리'
             AND THIRDQ_HANDI_CAP_RESULT IN ('승리',
                                             '적특')
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) D ON A.A_TEAM = D.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS fourth_handi_three_res
           FROM sport.basketball_data
           WHERE SECONDQ_FIRST_THREE_POINT = '승리'
             AND FOURTHQ_HANDI_CAP_RESULT IN ('승리',
                                              '적특')
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) E ON A.A_TEAM = E.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS first_handi_free_res
           FROM sport.basketball_data
           WHERE FIRSTQ_FIRST_FREE_TWO = '승리'
             AND FIRSTQ_HANDI_CAP_RESULT IN ('승리',
                                             '적특')
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) B2 ON A.A_TEAM = B2.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS second_handi_free_res
           FROM sport.basketball_data
           WHERE SECONDQ_FIRST_FREE_TWO = '승리'
             AND SECONDQ_HANDI_CAP_RESULT IN ('승리',
                                              '적특')
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) C2 ON A.A_TEAM = C2.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS third_handi_free_res
           FROM sport.basketball_data
           WHERE THIRDQ_FIRST_FREE_TWO = '승리'
             AND THIRDQ_HANDI_CAP_RESULT IN ('승리',
                                             '적특')
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) D2 ON A.A_TEAM = D2.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS fourth_handi_free_res
           FROM sport.basketball_data
           WHERE SECONDQ_FIRST_FREE_TWO = '승리'
             AND FOURTHQ_HANDI_CAP_RESULT IN ('승리',
                                              '적특')
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) E2 ON A.A_TEAM = E2.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS first_three_free_res
           FROM sport.basketball_data
           WHERE FIRSTQ_FIRST_FREE_TWO = '승리'
             AND FIRSTQ_FIRST_THREE_POINT = '승리'
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) B3 ON A.A_TEAM = B3.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS second_three_free_res
           FROM sport.basketball_data
           WHERE SECONDQ_FIRST_FREE_TWO = '승리'
             AND SECONDQ_FIRST_THREE_POINT = '승리'
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) C3 ON A.A_TEAM = C3.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS third_three_free_res
           FROM sport.basketball_data
           WHERE THIRDQ_FIRST_FREE_TWO = '승리'
             AND THIRDQ_FIRST_THREE_POINT = '승리'
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) D3 ON A.A_TEAM = D3.A_TEAM
        LEFT OUTER JOIN
          (SELECT LEAGUE,
                  A_TEAM,
                  COUNT(1) AS fourth_three_free_res
           FROM sport.basketball_data
           WHERE FOURTHQ_FIRST_FREE_TWO = '승리'
             AND FOURTHQ_FIRST_THREE_POINT = '승리'
             AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> GROUP  BY A_TEAM) E3 ON A.A_TEAM = E3.A_TEAM;
    </insert>

    <insert id="truncateBasketSpecialComboSummary">
        TRUNCATE sport.basketball_special_combo_summary;
    </insert>

    <insert id="truncateBasketQuarterHandiComboSummary">
        TRUNCATE sport.basketball_quarter_handi_combo_special;
    </insert>

    <insert id="insertBasketQuarterHandiComboSummary">
        INSERT INTO sport.basketball_quarter_handi_combo_special
            (
             LEAGUE,
             TEAM,
             FIRST_HANDI_WIN_OVER_PER,
             FIRST_HANDI_WIN_UNDER_PER,
             SECOND_HANDI_WIN_OVER_PER,
             SECOND_HANDI_WIN_UNDER_PER,
             THIRD_HANDI_WIN_OVER_PER,
             THIRD_HANDI_WIN_UNDER_PER,
             FOURTH_HANDI_WIN_OVER_PER,
             FOURTH_HANDI_WIN_UNDER_PER,
             FIRST_HANDI_LOSE_OVER_PER,
             FIRST_HANDI_LOSE_UNDER_PER,
             SECOND_HANDI_LOSE_OVER_PER,
             SECOND_HANDI_LOSE_UNDER_PER,
             THIRD_HANDI_LOSE_OVER_PER,
             THIRD_HANDI_LOSE_UNDER_PER,
             FOURTH_HANDI_LOSE_OVER_PER,
             FOURTH_HANDI_LOSE_UNDER_PER,
             RDATE
             )
        SELECT A.LEAGUE,
               A.A_TEAM ,
               first_handi_win_over_per ,
               first_handi_win_under_per ,
               second_handi_win_over_per ,
               second_handi_win_under_per ,
               third_handi_win_over_per ,
               third_handi_win_under_per ,
               fourth_handi_win_over_per ,
               fourth_handi_win_under_per ,
               first_handi_lose_over_per ,
               first_handi_lose_under_per ,
               second_handi_lose_over_per ,
               second_handi_lose_under_per ,
               third_handi_lose_over_per ,
               third_handi_lose_under_per ,
               fourth_handi_lose_over_per ,
               fourth_handi_lose_under_per ,
               NOW()
        FROM
          (SELECT A.LEAGUE,
                  A.A_TEAM,
                  allCnt ,
                  first_res,
                  ROUND(first_res/allCnt * 100, 1) AS first_handi_win_over_per
           FROM
             (SELECT LEAGUE,
                     A_TEAM,
                     COUNT(1) AS allCnt
              FROM sport.basketball_data
              WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                AND FIRSTQ_HANDI_CAP_RESULT != '적특'
              GROUP BY A_TEAM) A
           LEFT OUTER JOIN
             (SELECT LEAGUE,
                     A_TEAM,
                     COUNT(1) AS first_res
              FROM sport.basketball_data
              WHERE FIRSTQ_HANDI_CAP_RESULT = '승리'
                AND FIRSTQ_POINT_LINE_RESULT IN('오버',
                                                '적특')
                AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
              GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) A
        LEFT OUTER JOIN
          (SELECT A.LEAGUE,
                  A.A_TEAM,
                  allCnt ,
                  second_res,
                  ROUND(second_res/allCnt * 100, 1) AS second_handi_win_over_per
           FROM
             (SELECT LEAGUE,
                     A_TEAM,
                     COUNT(1) AS allCnt
              FROM sport.basketball_data
              WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                AND SECONDQ_HANDI_CAP_RESULT != '적특'
              GROUP BY A_TEAM) A
           LEFT OUTER JOIN
             (SELECT LEAGUE,
                     A_TEAM,
                     COUNT(1) AS second_res
              FROM sport.basketball_data
              WHERE SECONDQ_HANDI_CAP_RESULT = '승리'
                AND SECONDQ_POINT_LINE_RESULT IN('오버',
                                                 '적특')
                AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
              GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) B ON A.A_TEAM = B.A_TEAM
        LEFT OUTER JOIN
          (SELECT A.LEAGUE,
                  A.A_TEAM,
                  allCnt ,
                  third_res,
                  ROUND(third_res/allCnt * 100, 1) AS third_handi_win_over_per
           FROM
             (SELECT LEAGUE,
                     A_TEAM,
                     COUNT(1) AS allCnt
              FROM sport.basketball_data
              WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                AND THIRDQ_HANDI_CAP_RESULT != '적특'
              GROUP BY A_TEAM) A
           LEFT OUTER JOIN
             (SELECT LEAGUE,
                     A_TEAM,
                     COUNT(1) AS third_res
              FROM sport.basketball_data
              WHERE THIRDQ_HANDI_CAP_RESULT = '승리'
                AND THIRDQ_POINT_LINE_RESULT IN('오버',
                                                '적특')
                AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
              GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) C ON A.A_TEAM = C.A_TEAM
        LEFT OUTER JOIN
          (SELECT A.LEAGUE,
                  A.A_TEAM,
                  allCnt ,
                  fourth_res,
                  ROUND(fourth_res/allCnt * 100, 1) AS fourth_handi_win_over_per
           FROM
             (SELECT LEAGUE,
                     A_TEAM,
                     COUNT(1) AS allCnt
              FROM sport.basketball_data
              WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                AND FOURTHQ_HANDI_CAP_RESULT != '적특'
              GROUP BY A_TEAM) A
           LEFT OUTER JOIN
             (SELECT LEAGUE,
                     A_TEAM,
                     COUNT(1) AS fourth_res
              FROM sport.basketball_data
              WHERE FOURTHQ_HANDI_CAP_RESULT = '승리'
                AND FOURTHQ_POINT_LINE_RESULT IN('오버',
                                                 '적특')
                AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
              GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) D ON A.A_TEAM = D.A_TEAM
        LEFT OUTER JOIN
          (SELECT A2.LEAGUE,
                  A2.A_TEAM ,
                  first_handi_lose_over_per ,
                  second_handi_lose_over_per ,
                  third_handi_lose_over_per ,
                  fourth_handi_lose_over_per
           FROM
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                     allCnt ,
                     first_res,
                     ROUND(first_res/allCnt * 100, 1) AS first_handi_lose_over_per
              FROM
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS first_res
                 FROM sport.basketball_data
                 WHERE FIRSTQ_HANDI_CAP_RESULT = '패배'
                   AND FIRSTQ_POINT_LINE_RESULT IN('오버',
                                                   '적특')
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) A2
           LEFT OUTER JOIN
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                     allCnt ,
                     second_res,
                     ROUND(second_res/allCnt * 100, 1) AS second_handi_lose_over_per
              FROM
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND SECONDQ_HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS second_res
                 FROM sport.basketball_data
                 WHERE SECONDQ_HANDI_CAP_RESULT = '패배'
                   AND SECONDQ_POINT_LINE_RESULT IN('오버',
                                                    '적특')
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) B2 ON A2.A_TEAM = B2.A_TEAM
           LEFT OUTER JOIN
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                     allCnt ,
                     third_res,
                     ROUND(third_res/allCnt * 100, 1) AS third_handi_lose_over_per
              FROM
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND THIRDQ_HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS third_res
                 FROM sport.basketball_data
                 WHERE THIRDQ_HANDI_CAP_RESULT = '패배'
                   AND THIRDQ_POINT_LINE_RESULT IN('오버',
                                                   '적특')
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) C2 ON A2.A_TEAM = C2.A_TEAM
           LEFT OUTER JOIN
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                     allCnt ,
                     fourth_res,
                     ROUND(fourth_res/allCnt * 100, 1) AS fourth_handi_lose_over_per
              FROM
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS fourth_res
                 FROM sport.basketball_data
                 WHERE FOURTHQ_HANDI_CAP_RESULT = '패배'
                   AND FOURTHQ_POINT_LINE_RESULT IN('오버',
                                                    '적특')
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) D2 ON A2.A_TEAM = D2.A_TEAM) A2 ON A.A_TEAM = A2.A_TEAM
        LEFT OUTER JOIN
          (SELECT A.* ,
                  second_handi_win_under_per ,
                  third_handi_win_under_per ,
                  fourth_handi_win_under_per ,
                  first_handi_lose_under_per ,
                  second_handi_lose_under_per ,
                  third_handi_lose_under_per ,
                  fourth_handi_lose_under_per
           FROM
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                     allCnt ,
                     first_res,
                     ROUND(first_res/allCnt * 100, 1) AS first_handi_win_under_per
              FROM
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS first_res
                 FROM sport.basketball_data
                 WHERE FIRSTQ_HANDI_CAP_RESULT = '승리'
                   AND FIRSTQ_POINT_LINE_RESULT IN('언더',
                                                   '적특')
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) A
           LEFT OUTER JOIN
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                     allCnt ,
                     second_res,
                     ROUND(second_res/allCnt * 100, 1) AS second_handi_win_under_per
              FROM
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND SECONDQ_HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS second_res
                 FROM sport.basketball_data
                 WHERE SECONDQ_HANDI_CAP_RESULT = '승리'
                   AND SECONDQ_POINT_LINE_RESULT IN('언더',
                                                    '적특')
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) B ON A.A_TEAM = B.A_TEAM
           LEFT OUTER JOIN
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                     allCnt ,
                     third_res,
                     ROUND(third_res/allCnt * 100, 1) AS third_handi_win_under_per
              FROM
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND THIRDQ_HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS third_res
                 FROM sport.basketball_data
                 WHERE THIRDQ_HANDI_CAP_RESULT = '승리'
                   AND THIRDQ_POINT_LINE_RESULT IN('언더',
                                                   '적특')
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) C ON A.A_TEAM = C.A_TEAM
           LEFT OUTER JOIN
             (SELECT A.LEAGUE,
                     A.A_TEAM,
                     allCnt ,
                     fourth_res,
                     ROUND(fourth_res/allCnt * 100, 1) AS fourth_handi_win_under_per
              FROM
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS allCnt
                 FROM sport.basketball_data
                 WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                   AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM) A
              LEFT OUTER JOIN
                (SELECT LEAGUE,
                        A_TEAM,
                        COUNT(1) AS fourth_res
                 FROM sport.basketball_data
                 WHERE FOURTHQ_HANDI_CAP_RESULT = '승리'
                   AND FOURTHQ_POINT_LINE_RESULT IN('언더',
                                                    '적특')
                   AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                 GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) D ON A.A_TEAM = D.A_TEAM
           LEFT OUTER JOIN
             (SELECT A2.LEAGUE,
                     A2.A_TEAM ,
                     first_handi_lose_under_per ,
                     second_handi_lose_under_per ,
                     third_handi_lose_under_per ,
                     fourth_handi_lose_under_per
              FROM
                (SELECT A.LEAGUE,
                        A.A_TEAM,
                        allCnt ,
                        first_res,
                        ROUND(first_res/allCnt * 100, 1) AS first_handi_lose_under_per
                 FROM
                   (SELECT LEAGUE,
                           A_TEAM,
                           COUNT(1) AS allCnt
                    FROM sport.basketball_data
                    WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                      AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                    GROUP BY A_TEAM) A
                 LEFT OUTER JOIN
                   (SELECT LEAGUE,
                           A_TEAM,
                           COUNT(1) AS first_res
                    FROM sport.basketball_data
                    WHERE FIRSTQ_HANDI_CAP_RESULT = '패배'
                      AND FIRSTQ_POINT_LINE_RESULT IN('언더',
                                                      '적특')
                      AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                    GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) A2
              LEFT OUTER JOIN
                (SELECT A.LEAGUE,
                        A.A_TEAM,
                        allCnt ,
                        second_res,
                        ROUND(second_res/allCnt * 100, 1) AS second_handi_lose_under_per
                 FROM
                   (SELECT LEAGUE,
                           A_TEAM,
                           COUNT(1) AS allCnt
                    FROM sport.basketball_data
                    WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                      AND SECONDQ_HANDI_CAP_RESULT != '적특'
                    GROUP BY A_TEAM) A
                 LEFT OUTER JOIN
                   (SELECT LEAGUE,
                           A_TEAM,
                           COUNT(1) AS second_res
                    FROM sport.basketball_data
                    WHERE SECONDQ_HANDI_CAP_RESULT = '패배'
                      AND SECONDQ_POINT_LINE_RESULT IN('언더',
                                                       '적특')
                      AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                    GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) B2 ON A2.A_TEAM = B2.A_TEAM
              LEFT OUTER JOIN
                (SELECT A.LEAGUE,
                        A.A_TEAM,
                        allCnt ,
                        third_res,
                        ROUND(third_res/allCnt * 100, 1) AS third_handi_lose_under_per
                 FROM
                   (SELECT LEAGUE,
                           A_TEAM,
                           COUNT(1) AS allCnt
                    FROM sport.basketball_data
                    WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                      AND THIRDQ_HANDI_CAP_RESULT != '적특'
                    GROUP BY A_TEAM) A
                 LEFT OUTER JOIN
                   (SELECT LEAGUE,
                           A_TEAM,
                           COUNT(1) AS third_res
                    FROM sport.basketball_data
                    WHERE THIRDQ_HANDI_CAP_RESULT = '패배'
                      AND THIRDQ_POINT_LINE_RESULT IN('언더',
                                                      '적특')
                      AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                    GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) C2 ON A2.A_TEAM = C2.A_TEAM
              LEFT OUTER JOIN
                (SELECT A.LEAGUE,
                        A.A_TEAM,
                        allCnt ,
                        fourth_res,
                        ROUND(fourth_res/allCnt * 100, 1) AS fourth_handi_lose_under_per
                 FROM
                   (SELECT LEAGUE,
                           A_TEAM,
                           COUNT(1) AS allCnt
                    FROM sport.basketball_data
                    WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                      AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                    GROUP BY A_TEAM) A
                 LEFT OUTER JOIN
                   (SELECT LEAGUE,
                           A_TEAM,
                           COUNT(1) AS fourth_res
                    FROM sport.basketball_data
                    WHERE FOURTHQ_HANDI_CAP_RESULT = '패배'
                      AND FOURTHQ_POINT_LINE_RESULT IN('언더',
                                                       '적특')
                      AND <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]>
                    GROUP BY A_TEAM) B ON A.A_TEAM = B.A_TEAM) D2 ON A2.A_TEAM = D2.A_TEAM) A2 ON A.A_TEAM = A2.A_TEAM) A3 ON A.A_TEAM = A3.A_TEAM
    </insert>

    <select id="selectBasketballAllSummary" resultType="HashMap">
        SELECT A.idx,
               A.MATCH_TIME,
               A.GAME_ID,
               A.MATCH_DATE,
               A.A_TEAM,
               B.CONDI,
               CASE A.GROUND
                   WHEN '홈' THEN 1
                   ELSE 2
               END AS PRO ,
               HANDI_WIN_PER,
               HANDI_LOSE_PER,
               OVER_PER,
               UNDER_PER ,
               FIRST_FIRST_POINT_PER,
               SECOND_FIRST_POINT_PER,
               THIRD_FIRST_POINT_PER,
               FOURTH_FIRST_POINT_PER,
               FIRST_FIRST_TWO_POINT_PER,
               SECOND_FIRST_TWO_POINT_PER,
               THIRD_FIRST_TWO_POINT_PER,
               FOURTH_FIRST_TWO_POINT_PER,
               FIRST_FIRST_FREE_TWO_PER,
               SECOND_FIRST_FREE_TWO_PER,
               THIRD_FIRST_FREE_TWO_PER,
               FOURTH_FIRST_FREE_TWO_PER,
               FIRST_FIRST_THREE_POINT_PER,
               SECOND_FIRST_THREE_POINT_PER,
               THIRD_FIRST_THREE_POINT_PER,
               FOURTH_FIRST_THREE_POINT_PER ,
               FIRST_HANDI_WIN_PER,
               FIRST_HANDI_LOSE_PER,
               SECOND_HANDI_WIN_PER,
               SECOND_HANDI_LOSE_PER,
               THIRD_HANDI_WIN_PER,
               HIRD_HANDI_LOSE_PER,
               FOURTH_HANDI_WIN_PER,
               OURTH_HANDI_LOSE_PER,
               FIRST_OVER_PER,
               FIRST_UNDER_PER,
               SECOND_OVER_PER,
               SECOND_UNDER_PER,
               THIRD_OVER_PER,
               THIRD_UNDER_PER,
               FOURTH_OVER_PER,
               FOURTH_UNDER_PER,
               RDATE
        FROM
          (SELECT idx,
                  GAME_ID,
                  GROUND,
                  MATCH_DATE,
                  MATCH_TIME,
                  LEAGUE,
                  A_TEAM
           FROM sport.basketball_data
           WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> ) A
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  HANDI_WIN_PER,
                  HANDI_LOSE_PER,
                  OVER_PER,
                  UNDER_PER
           FROM sport.basketball_handi_over_summary
           WHERE FILTER = '전체' ) B ON A.A_TEAM = B.TEAM
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_FIRST_POINT_PER,
                  SECOND_FIRST_POINT_PER,
                  THIRD_FIRST_POINT_PER,
                  FOURTH_FIRST_POINT_PER,
                  FIRST_FIRST_TWO_POINT_PER,
                  SECOND_FIRST_TWO_POINT_PER,
                  THIRD_FIRST_TWO_POINT_PER,
                  FOURTH_FIRST_TWO_POINT_PER,
                  FIRST_FIRST_FREE_TWO_PER,
                  SECOND_FIRST_FREE_TWO_PER,
                  THIRD_FIRST_FREE_TWO_PER,
                  FOURTH_FIRST_FREE_TWO_PER,
                  FIRST_FIRST_THREE_POINT_PER,
                  SECOND_FIRST_THREE_POINT_PER,
                  THIRD_FIRST_THREE_POINT_PER,
                  FOURTH_FIRST_THREE_POINT_PER
           FROM sport.basketball_special_summary
           WHERE FILTER = '전체' ) C ON A.A_TEAM = C.TEAM
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_HANDI_WIN_PER,
                  FIRST_HANDI_LOSE_PER,
                  SECOND_HANDI_WIN_PER,
                  SECOND_HANDI_LOSE_PER,
                  THIRD_HANDI_WIN_PER,
                  HIRD_HANDI_LOSE_PER,
                  FOURTH_HANDI_WIN_PER,
                  OURTH_HANDI_LOSE_PER,
                  FIRST_OVER_PER,
                  FIRST_UNDER_PER,
                  SECOND_OVER_PER,
                  SECOND_UNDER_PER,
                  THIRD_OVER_PER,
                  THIRD_UNDER_PER,
                  FOURTH_OVER_PER,
                  FOURTH_UNDER_PER,
                  RDATE
           FROM sport.basketball_quarter_handi_over_summary
           WHERE FILTER = '전체' ) D ON A.A_TEAM = D.TEAM
        UNION
        SELECT A.idx,
               A.MATCH_TIME,
               A.GAME_ID,
               A.MATCH_DATE,
               A.A_TEAM,
               B.CONDI,
               CASE A.GROUND
                   WHEN '홈' THEN 3
                   ELSE 4
               END AS PRO ,
               HANDI_WIN_PER,
               HANDI_LOSE_PER,
               OVER_PER,
               UNDER_PER ,
               FIRST_FIRST_POINT_PER,
               SECOND_FIRST_POINT_PER,
               THIRD_FIRST_POINT_PER,
               FOURTH_FIRST_POINT_PER,
               FIRST_FIRST_TWO_POINT_PER,
               SECOND_FIRST_TWO_POINT_PER,
               THIRD_FIRST_TWO_POINT_PER,
               FOURTH_FIRST_TWO_POINT_PER,
               FIRST_FIRST_FREE_TWO_PER,
               SECOND_FIRST_FREE_TWO_PER,
               THIRD_FIRST_FREE_TWO_PER,
               FOURTH_FIRST_FREE_TWO_PER,
               FIRST_FIRST_THREE_POINT_PER,
               SECOND_FIRST_THREE_POINT_PER,
               THIRD_FIRST_THREE_POINT_PER,
               FOURTH_FIRST_THREE_POINT_PER ,
               FIRST_HANDI_WIN_PER,
               FIRST_HANDI_LOSE_PER,
               SECOND_HANDI_WIN_PER,
               SECOND_HANDI_LOSE_PER,
               THIRD_HANDI_WIN_PER,
               HIRD_HANDI_LOSE_PER,
               FOURTH_HANDI_WIN_PER,
               OURTH_HANDI_LOSE_PER,
               FIRST_OVER_PER,
               FIRST_UNDER_PER,
               SECOND_OVER_PER,
               SECOND_UNDER_PER,
               THIRD_OVER_PER,
               THIRD_UNDER_PER,
               FOURTH_OVER_PER,
               FOURTH_UNDER_PER,
               RDATE
        FROM
          (SELECT idx,
                  GAME_ID,
                  GROUND,
                  MATCH_DATE,
                  MATCH_TIME,
                  LEAGUE,
                  A_TEAM
           FROM sport.basketball_data
           WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> ) A
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  HANDI_WIN_PER,
                  HANDI_LOSE_PER,
                  OVER_PER,
                  UNDER_PER
           FROM sport.basketball_handi_over_summary) B ON A.A_TEAM = B.TEAM
        AND A.GROUND = B.CONDI
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_FIRST_POINT_PER,
                  SECOND_FIRST_POINT_PER,
                  THIRD_FIRST_POINT_PER,
                  FOURTH_FIRST_POINT_PER,
                  FIRST_FIRST_TWO_POINT_PER,
                  SECOND_FIRST_TWO_POINT_PER,
                  THIRD_FIRST_TWO_POINT_PER,
                  FOURTH_FIRST_TWO_POINT_PER,
                  FIRST_FIRST_FREE_TWO_PER,
                  SECOND_FIRST_FREE_TWO_PER,
                  THIRD_FIRST_FREE_TWO_PER,
                  FOURTH_FIRST_FREE_TWO_PER,
                  FIRST_FIRST_THREE_POINT_PER,
                  SECOND_FIRST_THREE_POINT_PER,
                  THIRD_FIRST_THREE_POINT_PER,
                  FOURTH_FIRST_THREE_POINT_PER
           FROM sport.basketball_special_summary) C ON A.A_TEAM = C.TEAM
        AND A.GROUND = C.CONDI
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_HANDI_WIN_PER,
                  FIRST_HANDI_LOSE_PER,
                  SECOND_HANDI_WIN_PER,
                  SECOND_HANDI_LOSE_PER,
                  THIRD_HANDI_WIN_PER,
                  HIRD_HANDI_LOSE_PER,
                  FOURTH_HANDI_WIN_PER,
                  OURTH_HANDI_LOSE_PER,
                  FIRST_OVER_PER,
                  FIRST_UNDER_PER,
                  SECOND_OVER_PER,
                  SECOND_UNDER_PER,
                  THIRD_OVER_PER,
                  THIRD_UNDER_PER,
                  FOURTH_OVER_PER,
                  FOURTH_UNDER_PER,
                  RDATE
           FROM sport.basketball_quarter_handi_over_summary) D ON A.A_TEAM = D.TEAM
        AND A.GROUND = D.CONDI
        UNION
        SELECT A.idx,
               A.MATCH_TIME,
               A.GAME_ID,
               A.MATCH_DATE,
               A.A_TEAM,
               B.CONDI,
               CASE A.GROUND
                   WHEN '홈' THEN 5
                   ELSE 6
               END AS PRO ,
               HANDI_WIN_PER,
               HANDI_LOSE_PER,
               OVER_PER,
               UNDER_PER ,
               FIRST_FIRST_POINT_PER,
               SECOND_FIRST_POINT_PER,
               THIRD_FIRST_POINT_PER,
               FOURTH_FIRST_POINT_PER,
               FIRST_FIRST_TWO_POINT_PER,
               SECOND_FIRST_TWO_POINT_PER,
               THIRD_FIRST_TWO_POINT_PER,
               FOURTH_FIRST_TWO_POINT_PER,
               FIRST_FIRST_FREE_TWO_PER,
               SECOND_FIRST_FREE_TWO_PER,
               THIRD_FIRST_FREE_TWO_PER,
               FOURTH_FIRST_FREE_TWO_PER,
               FIRST_FIRST_THREE_POINT_PER,
               SECOND_FIRST_THREE_POINT_PER,
               THIRD_FIRST_THREE_POINT_PER,
               FOURTH_FIRST_THREE_POINT_PER ,
               FIRST_HANDI_WIN_PER,
               FIRST_HANDI_LOSE_PER,
               SECOND_HANDI_WIN_PER,
               SECOND_HANDI_LOSE_PER,
               THIRD_HANDI_WIN_PER,
               HIRD_HANDI_LOSE_PER,
               FOURTH_HANDI_WIN_PER,
               OURTH_HANDI_LOSE_PER,
               FIRST_OVER_PER,
               FIRST_UNDER_PER,
               SECOND_OVER_PER,
               SECOND_UNDER_PER,
               THIRD_OVER_PER,
               THIRD_UNDER_PER,
               FOURTH_OVER_PER,
               FOURTH_UNDER_PER,
               RDATE
        FROM
          (SELECT idx,
                  GAME_ID,
                  GROUND,
                  MATCH_DATE,
                  MATCH_TIME,
                  LEAGUE,
                  A_TEAM,
                  ODD
           FROM sport.basketball_data
           WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> ) A
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  HANDI_WIN_PER,
                  HANDI_LOSE_PER,
                  OVER_PER,
                  UNDER_PER
           FROM sport.basketball_handi_over_summary) B ON A.A_TEAM = B.TEAM
        AND A.ODD = B.CONDI
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_FIRST_POINT_PER,
                  SECOND_FIRST_POINT_PER,
                  THIRD_FIRST_POINT_PER,
                  FOURTH_FIRST_POINT_PER,
                  FIRST_FIRST_TWO_POINT_PER,
                  SECOND_FIRST_TWO_POINT_PER,
                  THIRD_FIRST_TWO_POINT_PER,
                  FOURTH_FIRST_TWO_POINT_PER,
                  FIRST_FIRST_FREE_TWO_PER,
                  SECOND_FIRST_FREE_TWO_PER,
                  THIRD_FIRST_FREE_TWO_PER,
                  FOURTH_FIRST_FREE_TWO_PER,
                  FIRST_FIRST_THREE_POINT_PER,
                  SECOND_FIRST_THREE_POINT_PER,
                  THIRD_FIRST_THREE_POINT_PER,
                  FOURTH_FIRST_THREE_POINT_PER
           FROM sport.basketball_special_summary) C ON A.A_TEAM = C.TEAM
        AND A.ODD = C.CONDI
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_HANDI_WIN_PER,
                  FIRST_HANDI_LOSE_PER,
                  SECOND_HANDI_WIN_PER,
                  SECOND_HANDI_LOSE_PER,
                  THIRD_HANDI_WIN_PER,
                  HIRD_HANDI_LOSE_PER,
                  FOURTH_HANDI_WIN_PER,
                  OURTH_HANDI_LOSE_PER,
                  FIRST_OVER_PER,
                  FIRST_UNDER_PER,
                  SECOND_OVER_PER,
                  SECOND_UNDER_PER,
                  THIRD_OVER_PER,
                  THIRD_UNDER_PER,
                  FOURTH_OVER_PER,
                  FOURTH_UNDER_PER,
                  RDATE
           FROM sport.basketball_quarter_handi_over_summary) D ON A.A_TEAM = D.TEAM
        AND A.ODD = D.CONDI
        UNION
        SELECT A.idx,
               A.MATCH_TIME,
               A.GAME_ID,
               A.MATCH_DATE,
               A.A_TEAM,
               B.CONDI,
               CASE A.GROUND
                   WHEN '홈' THEN 7
                   ELSE 8
               END AS PRO ,
               HANDI_WIN_PER,
               HANDI_LOSE_PER,
               OVER_PER,
               UNDER_PER ,
               FIRST_FIRST_POINT_PER,
               SECOND_FIRST_POINT_PER,
               THIRD_FIRST_POINT_PER,
               FOURTH_FIRST_POINT_PER,
               FIRST_FIRST_TWO_POINT_PER,
               SECOND_FIRST_TWO_POINT_PER,
               THIRD_FIRST_TWO_POINT_PER,
               FOURTH_FIRST_TWO_POINT_PER,
               FIRST_FIRST_FREE_TWO_PER,
               SECOND_FIRST_FREE_TWO_PER,
               THIRD_FIRST_FREE_TWO_PER,
               FOURTH_FIRST_FREE_TWO_PER,
               FIRST_FIRST_THREE_POINT_PER,
               SECOND_FIRST_THREE_POINT_PER,
               THIRD_FIRST_THREE_POINT_PER,
               FOURTH_FIRST_THREE_POINT_PER ,
               FIRST_HANDI_WIN_PER,
               FIRST_HANDI_LOSE_PER,
               SECOND_HANDI_WIN_PER,
               SECOND_HANDI_LOSE_PER,
               THIRD_HANDI_WIN_PER,
               HIRD_HANDI_LOSE_PER,
               FOURTH_HANDI_WIN_PER,
               OURTH_HANDI_LOSE_PER,
               FIRST_OVER_PER,
               FIRST_UNDER_PER,
               SECOND_OVER_PER,
               SECOND_UNDER_PER,
               THIRD_OVER_PER,
               THIRD_UNDER_PER,
               FOURTH_OVER_PER,
               FOURTH_UNDER_PER,
               RDATE
        FROM
          (SELECT idx,
                  GAME_ID,
                  GROUND,
                  MATCH_DATE,
                  MATCH_TIME,
                  LEAGUE,
                  A_TEAM,
                  A_TEAM_REST_DAY
           FROM sport.basketball_data
           WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> ) A
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  HANDI_WIN_PER,
                  HANDI_LOSE_PER,
                  OVER_PER,
                  UNDER_PER
           FROM sport.basketball_handi_over_summary) B ON A.A_TEAM = B.TEAM
        AND A.A_TEAM_REST_DAY = B.CONDI
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_FIRST_POINT_PER,
                  SECOND_FIRST_POINT_PER,
                  THIRD_FIRST_POINT_PER,
                  FOURTH_FIRST_POINT_PER,
                  FIRST_FIRST_TWO_POINT_PER,
                  SECOND_FIRST_TWO_POINT_PER,
                  THIRD_FIRST_TWO_POINT_PER,
                  FOURTH_FIRST_TWO_POINT_PER,
                  FIRST_FIRST_FREE_TWO_PER,
                  SECOND_FIRST_FREE_TWO_PER,
                  THIRD_FIRST_FREE_TWO_PER,
                  FOURTH_FIRST_FREE_TWO_PER,
                  FIRST_FIRST_THREE_POINT_PER,
                  SECOND_FIRST_THREE_POINT_PER,
                  THIRD_FIRST_THREE_POINT_PER,
                  FOURTH_FIRST_THREE_POINT_PER
           FROM sport.basketball_special_summary) C ON A.A_TEAM = C.TEAM
        AND A.A_TEAM_REST_DAY = C.CONDI
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_HANDI_WIN_PER,
                  FIRST_HANDI_LOSE_PER,
                  SECOND_HANDI_WIN_PER,
                  SECOND_HANDI_LOSE_PER,
                  THIRD_HANDI_WIN_PER,
                  HIRD_HANDI_LOSE_PER,
                  FOURTH_HANDI_WIN_PER,
                  OURTH_HANDI_LOSE_PER,
                  FIRST_OVER_PER,
                  FIRST_UNDER_PER,
                  SECOND_OVER_PER,
                  SECOND_UNDER_PER,
                  THIRD_OVER_PER,
                  THIRD_UNDER_PER,
                  FOURTH_OVER_PER,
                  FOURTH_UNDER_PER,
                  RDATE
           FROM sport.basketball_quarter_handi_over_summary) D ON A.A_TEAM = D.TEAM
        AND A.A_TEAM_REST_DAY = D.CONDI
        UNION
        SELECT A.idx,
               A.MATCH_TIME,
               A.GAME_ID,
               A.MATCH_DATE,
               A.A_TEAM,
               B.CONDI,
               CASE A.GROUND
                   WHEN '홈' THEN 9
                   ELSE 10
               END AS PRO ,
               HANDI_WIN_PER,
               HANDI_LOSE_PER,
               OVER_PER,
               UNDER_PER ,
               FIRST_FIRST_POINT_PER,
               SECOND_FIRST_POINT_PER,
               THIRD_FIRST_POINT_PER,
               FOURTH_FIRST_POINT_PER,
               FIRST_FIRST_TWO_POINT_PER,
               SECOND_FIRST_TWO_POINT_PER,
               THIRD_FIRST_TWO_POINT_PER,
               FOURTH_FIRST_TWO_POINT_PER,
               FIRST_FIRST_FREE_TWO_PER,
               SECOND_FIRST_FREE_TWO_PER,
               THIRD_FIRST_FREE_TWO_PER,
               FOURTH_FIRST_FREE_TWO_PER,
               FIRST_FIRST_THREE_POINT_PER,
               SECOND_FIRST_THREE_POINT_PER,
               THIRD_FIRST_THREE_POINT_PER,
               FOURTH_FIRST_THREE_POINT_PER ,
               FIRST_HANDI_WIN_PER,
               FIRST_HANDI_LOSE_PER,
               SECOND_HANDI_WIN_PER,
               SECOND_HANDI_LOSE_PER,
               THIRD_HANDI_WIN_PER,
               HIRD_HANDI_LOSE_PER,
               FOURTH_HANDI_WIN_PER,
               OURTH_HANDI_LOSE_PER,
               FIRST_OVER_PER,
               FIRST_UNDER_PER,
               SECOND_OVER_PER,
               SECOND_UNDER_PER,
               THIRD_OVER_PER,
               THIRD_UNDER_PER,
               FOURTH_OVER_PER,
               FOURTH_UNDER_PER,
               RDATE
        FROM
          (SELECT idx,
                  GAME_ID,
                  GROUND,
                  MATCH_DATE,
                  MATCH_TIME,
                  LEAGUE,
                  A_TEAM,
                  DAY_OF_WEEK
           FROM sport.basketball_data
           WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> ) A
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  HANDI_WIN_PER,
                  HANDI_LOSE_PER,
                  OVER_PER,
                  UNDER_PER
           FROM sport.basketball_handi_over_summary) B ON A.A_TEAM = B.TEAM
        AND A.DAY_OF_WEEK = B.CONDI
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_FIRST_POINT_PER,
                  SECOND_FIRST_POINT_PER,
                  THIRD_FIRST_POINT_PER,
                  FOURTH_FIRST_POINT_PER,
                  FIRST_FIRST_TWO_POINT_PER,
                  SECOND_FIRST_TWO_POINT_PER,
                  THIRD_FIRST_TWO_POINT_PER,
                  FOURTH_FIRST_TWO_POINT_PER,
                  FIRST_FIRST_FREE_TWO_PER,
                  SECOND_FIRST_FREE_TWO_PER,
                  THIRD_FIRST_FREE_TWO_PER,
                  FOURTH_FIRST_FREE_TWO_PER,
                  FIRST_FIRST_THREE_POINT_PER,
                  SECOND_FIRST_THREE_POINT_PER,
                  THIRD_FIRST_THREE_POINT_PER,
                  FOURTH_FIRST_THREE_POINT_PER
           FROM sport.basketball_special_summary) C ON A.A_TEAM = C.TEAM
        AND A.DAY_OF_WEEK = C.CONDI
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_HANDI_WIN_PER,
                  FIRST_HANDI_LOSE_PER,
                  SECOND_HANDI_WIN_PER,
                  SECOND_HANDI_LOSE_PER,
                  THIRD_HANDI_WIN_PER,
                  HIRD_HANDI_LOSE_PER,
                  FOURTH_HANDI_WIN_PER,
                  OURTH_HANDI_LOSE_PER,
                  FIRST_OVER_PER,
                  FIRST_UNDER_PER,
                  SECOND_OVER_PER,
                  SECOND_UNDER_PER,
                  THIRD_OVER_PER,
                  THIRD_UNDER_PER,
                  FOURTH_OVER_PER,
                  FOURTH_UNDER_PER,
                  RDATE
           FROM sport.basketball_quarter_handi_over_summary) D ON A.A_TEAM = D.TEAM
        AND A.DAY_OF_WEEK = D.CONDI
        UNION
        SELECT A.idx,
               A.MATCH_TIME,
               A.GAME_ID,
               NULL,
               NULL,
               NULL,
               CASE A.GROUND
                   WHEN '홈' THEN 0
                   ELSE 0
               END AS PRO ,
               NULL,
               NULL,
               NULL,
               NULL ,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL ,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               NULL,
               RDATE
        FROM
          (SELECT idx,
                  GAME_ID,
                  GROUND,
                  MATCH_DATE,
                  MATCH_TIME,
                  LEAGUE,
                  A_TEAM
           FROM sport.basketball_data
           WHERE <![CDATA[  MATCH_DATE < DATE_ADD(NOW(), INTERVAL - 1 DAY)   ]]> ) A
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  HANDI_WIN_PER,
                  HANDI_LOSE_PER,
                  OVER_PER,
                  UNDER_PER
           FROM sport.basketball_handi_over_summary) B ON A.A_TEAM = B.TEAM
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_FIRST_POINT_PER,
                  SECOND_FIRST_POINT_PER,
                  THIRD_FIRST_POINT_PER,
                  FOURTH_FIRST_POINT_PER,
                  FIRST_FIRST_TWO_POINT_PER,
                  SECOND_FIRST_TWO_POINT_PER,
                  THIRD_FIRST_TWO_POINT_PER,
                  FOURTH_FIRST_TWO_POINT_PER,
                  FIRST_FIRST_FREE_TWO_PER,
                  SECOND_FIRST_FREE_TWO_PER,
                  THIRD_FIRST_FREE_TWO_PER,
                  FOURTH_FIRST_FREE_TWO_PER,
                  FIRST_FIRST_THREE_POINT_PER,
                  SECOND_FIRST_THREE_POINT_PER,
                  THIRD_FIRST_THREE_POINT_PER,
                  FOURTH_FIRST_THREE_POINT_PER
           FROM sport.basketball_special_summary) C ON A.A_TEAM = C.TEAM
        INNER JOIN
          (SELECT TEAM,
                  CONDI,
                  FIRST_HANDI_WIN_PER,
                  FIRST_HANDI_LOSE_PER,
                  SECOND_HANDI_WIN_PER,
                  SECOND_HANDI_LOSE_PER,
                  THIRD_HANDI_WIN_PER,
                  HIRD_HANDI_LOSE_PER,
                  FOURTH_HANDI_WIN_PER,
                  OURTH_HANDI_LOSE_PER,
                  FIRST_OVER_PER,
                  FIRST_UNDER_PER,
                  SECOND_OVER_PER,
                  SECOND_UNDER_PER,
                  THIRD_OVER_PER,
                  THIRD_UNDER_PER,
                  FOURTH_OVER_PER,
                  FOURTH_UNDER_PER,
                  RDATE
           FROM sport.basketball_quarter_handi_over_summary) D ON A.A_TEAM = D.TEAM
        WHERE A.GROUND = '홈'
        ORDER BY MATCH_TIME,
                 GAME_ID DESC,
                 PRO ;
    </select>
</mapper>